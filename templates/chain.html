<html>
<head>
  <title>Home | Dashboard</title>
  <link rel="shortcut icon" type="image/png" href="/gui/img/favicon.png"/>
  <link rel="stylesheet" href="/gui/css/shared.css">
  <link rel="stylesheet" href="/gui/css/navbar.css">
  <link rel="stylesheet" href="/gui/css/tabs.css">
  <link rel="stylesheet" href="/gui/css/modal.css">
  <link rel="stylesheet" href="/gui/jquery/jquery.dataTables.min.css">
  <link rel="stylesheet" href="/gui/css/basic.css">
  <link rel="stylesheet" href="/gui/css/timeline.css">
  <link rel="stylesheet" href="/gui/css/range.css">
  <link rel="stylesheet" href="/gui/css/reports.css">
</head>
<body style="margin-bottom: 100px">

<div class="navbar">
  <a href="/">Home</a>
  <div class="subnav">
    <button class="subnavbtn">Campaigns <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content">
      <a onclick="viewSection('agents')">agents</a>
      <a onclick="viewSection('adversaries')">adversaries</a>
      <a onclick="viewSection('operations')">operations</a>
    </div>
  </div>
  <a href="/logout" style="float:right">Logout</a>
  <a href="/docs/index.html" style="float:right" target="_blank">Docs</a>
  <div class="subnav-right">
    <button class="subnavbtn">Advanced <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content subnav-content-right">
        <a onclick="viewSection('sources')">sources</a>
        <a onclick="viewSection('planners')">planners</a>
        <a onclick="viewSection('c2')">c2</a>
        <a onclick="viewSection('obfuscators')">obfuscators</a>
    </div>
  </div>
  <div class="subnav-right">
    <button class="subnavbtn">Plugins <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content subnav-content-right">
        {% for plugin in plugins %}
          {% if plugin.address %}
              <a href="{{ plugin.address }}">{{ plugin.name }}</a>
          {% else %}
              <a onclick="alert('No GUI component to this plugin')">{{ plugin.name }}</a>
          {% endif %}
        {% endfor %}
    </div>
  </div>
</div>
<div id="notice" class="notice" style="display:none">Chrome is the only supported browser. Please change to that or some website components may not work.</div>

<div class="column" style="flex:100%;margin-top:0">
  <center>

    <div id="atomic-blocks" class="row-canvas">
      <center>

        <div id="intro" class="home-box watermark">
            <h1 id="big-head" class="big-head">CALDERA</h1>
            <hr style="width:70%">
            <h3 id="sub-head" class="small-head" style="margin-bottom: 20px;margin-top:0;">Cyber Adversary Language and Decision Engine for Red Team Automation</h3>
            <div style="opacity:0.5">
                <span>{{ exploits|length }} abilities&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
                <span>{{ tactics|length }} tactics&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
                <span>{{ payloads|length }} payloads&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
                <span>{{ adversaries|length }} adversaries&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
                <span>{{ agents|length }} agents</span>
            </div>
        </div>

        <!-- agents -->

        <div id="agents" class="section-profile" style="display: none">
          <div class="row">
            <div class="topleft duk-icon"><img onclick="removeSection('agents')" src="/gui/img/x.png"></div>
            <div class="topright duk-icon"><img onclick="openDuk4()" src="/gui/img/duk.png"></div>
            <div class="bottomright duk-icon"><img onclick="toggleSidebar('agents-sidebar')" src="/gui/img/expand.png"></div>
            <div id="agents-sidebar" class="column section-border" style="flex:25%;">
              <img src="/gui/img/group.png">
              <h4 style="margin-bottom:-5px">Agents</h4>
              <p class="section-description">
                  Groups are collections of agents so hosts can be compromised simultaneously. You must deploy at
                  least 1 agent in order to run an operation.
              </p>
              <button type="button" class="button-embedded atomic-button" onclick="saveGroupsCallback()">Refresh agent table</button>
              <button id="addGroupBtn" type="button" class="button-success atomic-button" onclick="saveGroups()">Save changes</button>
            </div>
            <div class="column" style="flex:75%">
              <table id="netTbl" class="display" style="width:100%;" >
                <thead>
                <tr>
                  <th>PAW</th>
                  <th>Host</th>
                  <th>Status</th>
                  <th>Platform</th>
                  <th>Executors</th>
                  <th>Last Seen</th>
                  <th>Sleep (Min/Max)</th>
                  <th>PID</th>
                  <th>Privilege</th>
                  <th>Group</th>
                  <th></th>
                </tr>
                </thead>
              </table>
            </div>

          </div>
        </div>

        <!-- sources -->

        <div id="sources" class="section-profile" style="display: none">
          <div class="advanced row">
              <div class="topleft duk-icon"><img onclick="removeSection('sources')" src="/gui/img/x.png"></div>
              <div class="topright duk-icon"><img onclick="openDuk5()" src="/gui/img/duk.png"></div>
              <div class="bottomright duk-icon"><img onclick="toggleSidebar('sources-sidebar')" src="/gui/img/expand.png"></div>
              <div id="sources-sidebar"  class="column section-border" style="flex:25%">
              <img src="/gui/img/facts.png">
              <h4>Sources</h4>
              <br>
              <div class="toggle">
                <label class="switch"><input type="checkbox" id="togBtnSrc" onchange="toggleSourceView()">
                  <div class="slider round"><span class="on">ADD</span><span class="off">VIEW</span></div>
                </label>
              </div>
              <br>
              <p class="section-description">
                  Facts are identifiable pieces of data, collected by agents or loaded when the server starts.
                  A source is a collection of facts. Rules are boundaries to ensure specific traits cannot be used.
              </p>
              <br>
              <div id="viewSource">
                  <select id="profile-source-name" style="margin-top:-15px" onchange="loadSource();">
                    <option value="" disabled selected>Select an existing source</option>
                    {% for s in sources %}
                        <option value="{{ s.id }}">{{ s.name }}</option>
                    {% endfor %}}
                  </select>
                  <br><br>
              </div>
              <div id="addSource"></div>
              <button id="sourceBtn" type="button" class="button-success atomic-button"
                      onclick="viewRules()">View rules
              </button>
              <button id="saveSourceBtn" type="button" class="button-success atomic-button"
                      onclick="saveSource()">Save
              </button>
            </div>
            <div class="column adversary-header" style="flex:75%;overflow:hidden;text-align:left">
                <input id="source-name" type="text" class="advGoal" placeholder="Enter source name"/>
                <br><br>
                <table id="factTbl" class="display ttp-template" style="width:100%;text-align:left">
                    <thead>
                        <tr>
                          <th></th>
                          <th></th>
                          <th></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <p style="color:white;text-align:right;font-size:16px;" onclick="addFactRow([
                    'Enter trait', 'Enter value','<p onclick=removeFactRow($(this))>&#x274C;</p>'])">
                    &#10010;&nbsp;add row
                </p>
            </div>
          </div>
        </div>

        <!-- adversary -->

        <div id="adversaries" class="section-profile" style="display: none">
          <div class="row">
            <div class="bottomright duk-icon"><img onclick="toggleSidebar('adversaries-sidebar')" src="/gui/img/expand.png"></div>
            <div class="topleft duk-icon"><img onclick="removeSection('adversaries')" src="/gui/img/x.png"></div>
            <div class="topright duk-icon"><img onclick="openDuk2()" src="/gui/img/duk.png"></div>
            <div id="adversaries-sidebar" class="column section-border" style="flex:25%;">
              <img src="/gui/img/hacker.png">
              <h4>Adversaries</h4>
              <br>
              <div class="toggle">
                <label class="switch"><input type="checkbox" id="togBtnAdv" onchange="toggleAdversaryView()">
                  <div class="slider round"><span class="on">ADD</span><span class="off">VIEW</span></div>
                </label>
              </div>
              <br>
              <p class="section-description">
                  Adversaries are collections of ATT&CK TTPs, designed to test specific threats. Build or review
                  existing adversaries here.
              </p>
                <br>
              <div id="viewAdversary">
                  <select id="profile-existing-name" style="margin-top:-15px" onchange="loadAdversary();">
                    <option value="" disabled selected>Select an existing adversary</option>
                    {% for adv in adversaries %}
                        <option value="{{ adv.adversary_id }}">{{ adv.name }}</option>
                    {% endfor %}}
                  </select>
                  <button class="button-embedded" onclick="addPhase(null)">Add phase</button>
              </div>
              <button id="advNewBtn" type="button" class="button-success atomic-button" onclick="saveAdversary()">Save</button>
              <div id="adv-flashy-holder">
                <span id="message"></span>
              </div>
            </div>
            <div id="phases" class="column adversary-header" style="flex:75%;text-align: left">
                <input id="profile-goal" type="text" class="advGoal" placeholder="enter an adversary name">
                <input id="profile-description" type="text" placeholder="enter an adversary description">
                <br><br>
                <div id="dummy"></div>
            </div>
          </div>
        </div>

        <div id="planners" class="section-profile planners" style="display: none">
          <div class="advanced row">
            <div class="topright duk-icon"><img onclick="openDuk7()" src="/gui/img/duk.png"></div>
            <div class="bottomright duk-icon"><img onclick="toggleSidebar('planners-sidebar')" src="/gui/img/expand.png"></div>
            <div class="topleft duk-icon"><img onclick="removeSection('planners')" src="/gui/img/x.png"></div>
            <div id="planners-sidebar" class="column section-border" style="flex:25%">
              <img src="/gui/img/planners.png">
              <h4>Planners</h4>
              <p class="section-description">
                  A planner is a module which contains logic for how a running operation should make decisions about
                  which abilities to use and in what order.

                  Specifically, a planner's logic contains the decision making to execute a single phase of an operation.
              </p>
              <br>
              <div id="viewPlanner">
                  <select id="planner-select" style="margin-top:-15px" onchange="loadPlanner()">
                    <option value="" disabled selected>Select an existing planner</option>
                    {% for p in planners %}
                      <option value="{{ p.name }}">{{ p.name }} planner</option>
                    {% endfor %}
                  </select>
              </div>
              <div>
                 <button id="savePlannerButton" type="button" class="button-success atomic-button"
                      onclick="savePlanner()">Save
              </button>
              </div>
            </div>

            <div id="planner-info" class="column planner-header" style="flex:75%;text-align: left">
              <h3 id="planner-title"></h3>
              <p id="planner-description"></p>
                <p>&nbsp; </p>
                 <p>&nbsp;</p>
              <h4 id="stop-conditions"></h4>
                 <table id="StopConditionTbl" class="display ttp-template" style="width:100%;text-align:left;display:none">
                    <thead>
                        <tr>
                          <th></th>
                          <th></th>
                          <th></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <p id="add_sc_button" style="color:white;text-align:right;font-size:16px;display:none;" onclick="addStopConditionRow([
                    'Enter trait', 'Enter value','<p onclick=removeStopConditionRow($(this))>&#x274C;</p>'])">
                    &#10010;&nbsp;add row
                </p>
            </div>
          </div>
        </div>

        <div id="c2" class="section-profile" style="display: none">
          <div class="advanced row">
            <div class="bottomright duk-icon"><img onclick="toggleSidebar('c2-sidebar')" src="/gui/img/expand.png"></div>
            <div class="topleft duk-icon"><img onclick="removeSection('c2')" src="/gui/img/x.png"></div>

            <div id="c2-sidebar" class="column section-border" style="flex:25%">
              <img src="/gui/img/group.png">
              <h4>C2</h4>
              <p class="section-description">
                  A C2 is a command-and-control mechanism for agent-to-server communication. There are various
                  types of communication protocols that can be used - and within this system - you can flexibly
                  create and select how you want your agents to call back.
              </p>
              <br>
              <div id="viewC2">
                  <select id="C2-select" onchange="showC2( {{ contacts }} )" style="margin-top:-15px">
                    <option value="" disabled selected>Select an existing C2</option>
                    {% for c in contacts %}
                      <option value="{{ c.name }}">{{ c.name }}</option>
                    {% endfor %}
                  </select>
              </div>
            </div>
            <div class="column planner-header" style="flex:75%;text-align: left">
              <h3 id="c2-name"></h3>
              <p id="c2-description"></p>
            </div>
          </div>
        </div>

        <div id="obfuscators" class="section-profile" style="display: none">
          <div class="advanced row">
            <div class="topleft duk-icon"><img onclick="removeSection('obfuscators')" src="/gui/img/x.png"></div>
            <div class="column planner-header" style="flex:100%;text-align: left">
                <table class="obfuscation-table" border=1 frame=void rules=rows>
                    {% for o in obfuscators %}
                        <tr>
                            <td><img src="/gui/img/obfuscation.png"/></td>
                            <td><h4>{{ o.name }}</h4></td>
                            <td>{{ o.description }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
          </div>
        </div>

        <!-- operation -->

        <div id="operations" class="section-profile" style="display: none">
          <div class="row">
            <div class="bottomright duk-icon"><img onclick="toggleSidebar('operations-sidebar')" src="/gui/img/expand.png"></div>
            <div class="topleft duk-icon"><img onclick="removeSection('operations')" src="/gui/img/x.png"></div>
            <div class="topright duk-icon"><img onclick="openDuk3()" src="/gui/img/duk.png"></div>
            <div id="operations-sidebar" class="column section-border" style="flex:25%">
              <img src="/gui/img/operation.png">
              <h4>Operations</h4>
              <br>
              <div class="toggle">
                <label class="switch"><input type="checkbox" id="togBtnOp" onchange="toggleOperationView()">
                  <div class="slider round"><span class="on">ADD</span><span class="off">VIEW</span></div>
                </label>
              </div>
              <p class="section-description">
                Start a new operation or review previous ones here.
              </p>
              <div id="viewOperation">
                <select id="operation-list" style="margin-bottom: 15px;" onchange="refresh();checkOpBtns()">
                  <option id="operationDefault" value="" disabled selected>Operations</option>
                  {% for op in operations %}
                        {%  if op.start|length%}
                            <option class="operationOption" id="{{ op.id }}-{{ op.name }}" value="{{ op.id }}">{{ op.name }} - {{ op.start }}</option>
                        {% endif %}
                  {% endfor %}
                </select>
                <br>
                <center>
                <table>
                    <tr>
                        <td><input id="agent-output" type="checkbox"></td>
                        <td><label for="agent-output"><p>&nbsp;&nbsp;include agent output</p></label></td>
                    </tr>
                </table>
                </center>
                <button id="reportBtn" type="button" class="button-notready atomic-button" onclick="downloadOperationReport()">Download report</button>
                <hr>
                <button id="opDelete" type="button" class="button-notready atomic-button" onclick="deleteOperation()">Delete</button>
              </div>
              <div id="addOperation" style="display: none;">
                  <input id="queueName" class="queueOption" style="opacity:0.5" disabled="true" placeholder="Operation name" oninput="checkOpformValid()"/>
                  <div id="optional" class="column sidebar-cutout">
                      <h5>OPTIONAL &#8595;</h5>
                  </div>
                  <div id="optional-options" class="column sidebar-cutout" style="display: none">
                      <select name="host" id="queueGroup" class="queueOption" style="opacity:0.5" disabled="true" onchange="checkOpformValid()">
                        <option value="" disabled selected>Use all groups</option>
                        {% for g in groups %}
                            <option id="qgroup-{{ g }}" value="{{ g }}">{{ g }}</option>
                        {% endfor %}
                      </select>
                      <select name="work" id="queueFlow" class="queueOption" style="opacity:0.5" disabled="true">
                        <option value="" disabled selected>No adversary chosen</option>
                        {% for adv in adversaries %}
                          <option id="qflow-{{ adv.adversary_id }}" value="{{ adv.adversary_id }}">{{ adv.name }}</option>
                        {% endfor %}
                      </select>
                      <select name="state" id="queueState" class="queueOption" style="opacity:0.5" disabled="false">
                        <option id="qstate-run" value="running">Run immediately</option>
                        <option id="qstate-paused" value="paused">Pause on start</option>
                      </select>
                      <select name="planner" id="queuePlanner" class="queueOption" style="opacity:0.5" disabled="true">
                        {% for p in planners %}
                            <option value="{{ p.name }}">Use {{ p.name }} planner</option>
                        {% endfor %}
                      </select>
                      <select name="source" id="queueSource" class="queueOption" style="opacity:0.5" disabled="true">
                        {% for s in sources %}
                            <option value="{{ s.name }}">Use {{ s.name }} facts</option>
                        {% endfor %}
                      </select>
                      <select name="untrusted" id="queueUntrusted" class="queueOption" style="opacity:0.5" disabled="true">
                        <option value="0">Block untrusted agents</option>
                        <option value="1" selected>Allow untrusted agents</option>
                      </select>
                      <select name="autonomous" id="queueAuto" class="queueOption" style="opacity:0.5" disabled="true">
                        <option value="1" selected>Run autonomously</option>
                        <option value="0">Require manual approval</option>
                      </select>
                      <select name="phases" id="queuePhasesEnabled" class="queueOption" style="opacity:0.5" disabled="true">
                        <option value="1" selected>Enable Phases</option>
                        <option value="0">Disable Phases</option>
                      </select>
                      <select name="phases" id="queueAutoClose" class="queueOption" style="opacity:0.5" disabled="true">
                        <option value="1" selected>Auto close operation</option>
                        <option value="0">Keep open for max time</option>
                      </select>
                      <select name="phases" id="queueObfuscated" class="queueOption" style="opacity:0.5" disabled="true">
                          {% for o in obfuscators %}
                            <option value="{{ o.name }}">{{ o.name }} obfuscation</option>
                          {% endfor %}
                      </select>
                      <input name="jitter" id="queueJitter" class="queueOption" placeholder="Jitter (min/max) sec" style="opacity:0.5;" disabled="true" helpinfo="jitterInfo"/>
                      <p style="margin-bottom:-20px">Visibility factor</p>
                      <input id="queueVisibility" class="queueOption" type="range" value="51">
                      <div id="h4-container"><div id="h4-subcontainer"><h4 id="visibility-label">0<span></span></h4></div></div>
                  </div>

                  <div id="schedules" class="column sidebar-cutout">
                      <h5>SCHEDULE &#8595;</h5>
                  </div>
                  <div id="schedules-options" class="column sidebar-cutout" style="display: none;">
                      <p>
                          You can schedule this operation to run daily at the same time:
                      </p>
                      <select id="schedule-hour" class="avoid-alphabetizing" onchange="checkOpformValid()">
                          <option selected disabled>Select hour</option>
                          {% for n in range(23) %}
                              <option value={{ n }} >Hour = {{ n }}</option>
                          {% endfor %}
                      </select>
                      <select id="schedule-minute" class="avoid-alphabetizing" onchange="checkOpformValid()">
                          <option selected disabled>Select minute</option>
                          {% for n in range(60) %}
                              <option value={{ n }} >Minute = {{ n }}</option>
                          {% endfor %}
                      </select>
                      <button id="scheduleBtn" type="button" style="opacity:0.5;width:40%;border-radius:0;" disabled="true"
                      class="button-notready atomic-button" onclick="handleScheduleAction()">Schedule
                        </button>
                      <div id="operation-flash">
                          <span id="message"></span>
                      </div>
                  </div>
                  <br>
                  <button id="opBtn" type="button" style="opacity:0.5" disabled="true"
                      class="button-notready atomic-button" onclick="handleStartAction()">Start
                  </button>
              </div>
            </div>
            <div class="column op-selected" style="flex:75%">
              <div class="op-dets">
                <center>
                    <div class="op-control-container">
                        <span title="Complete Operation" class="op-control-item"><button id="op-control-stop" onclick="changeCurrentOperationState('finished')">&#9632;</button></span>
                        <span title="Pause Operation" class="op-control-item"><button id="op-control-pause" onclick="changeCurrentOperationState('paused')">&#2405;</button></span>
                        <span title="Run One Step" class="op-control-item"><button id="run-one-link" onclick="changeCurrentOperationState('run_one_link')">&#9658;&#10072;</button></span>
                        <span title="Run Operation" class="op-control-item"><button id="op-control-run" onclick="changeCurrentOperationState('running')">&#9658;</button></span>
                        <br>
                        <div class="toggle">
                            <label class="switch"><input type="checkbox" id="togBtnHil" onchange="toggleHil()">
                                <div class="slider round"><span class="on">Autonomous&emsp;&emsp;</span><span class="off">Manual Approval</span></div>
                            </label>
                        </div>
                    </div>
                    <br>
                    <span title="Current Operation Status" class="op-control-text" id="op-control-state"></span>
                    <br><br>
                    <div id="myProgress" style="text-align: left">
                      <div id="myBar">0%</div>
                    </div>
                    <br>
                    <table class="legend">
                      <tr>
                          <td class="queued">queued</td>
                          <td class="collected">collected</td>
                          <td class="success">success</td>
                          <td class="failure">failure</td>
                          <td class="timeout">timeout</td>
                          <td class="discarded">discarded</td>
                          <td class="untrusted">untrusted</td>
                      </tr>
                    </table>
                </center>
              </div>
              <div id="content">
                  <span class="op-potential-links" onclick="document.getElementById('potential-modal').style.display='block';">&#10010; potential links</span>
                  <br>
                  <ul id="timeline" class="timeline">
                      <li id="time-start">
                  </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- modals-->

        <div id="more-modal" class="modal">
            <form class="modal-content ability-viewer">
                <div class="imgcontainer">
                  <span onclick="resetMoreModal();" class="close" title="Close Modal">&times;</span>
                </div>
                <div class="container" style="text-align:left">
                    <code id="resultCmd"></code>
                    <hr>
                    <pre id="resultView" style="text-align: left;max-width:800px;"></pre>
                </div>
             </form>
        </div>

        <div id="phase-modal" class="modal">
            <form class="modal-content">
                <div class="container section-profile row ability-viewer modal-box">
                    <div class="column" style="flex:100%;">
                        <select id="ability-tactic-filter" onchange="populateTechniques('phase-modal', {{ exploits }});">
                            <option disabled selected>Choose a tactic</option>
                            {% for tactic in tactics %}
                                <option value={{ tactic }} data-tactic={{ tactic }}>{{ tactic }}</option>
                            {% endfor %}}
                        </select>
                        <select id="ability-technique-filter" onchange="populateAbilities('phase-modal', {{ exploits }});">
                            <option disabled selected>Choose a technique</option>
                        </select>
                        <select id="ability-ability-filter" onchange="showAbility('phase-modal',  {{ exploits }})">
                            <option disabled selected>0 abilities</option>
                        </select>
                        <br><br>
                        <div class="ability-attack row-simple">
                            <div class="column" style="flex:60%">
                                <table frame=void rules=rows style="border-spacing:2px;width:100%">
                                    <tr>
                                        <td style="width:10%"><b>id:</b></td>
                                        <td><input type="text" id="ability-identifier" placeholder="Unique identifier"></td>
                                    </tr>
                                    <tr>
                                        <td style="width:10%"><b>name:</b></td>
                                        <td><input type="text" id="ability-name" placeholder="Name"></td>
                                    </tr>
                                    <tr>
                                        <td style="width:10%"><b>description:</b></td>
                                        <td><input type="text" id="ability-description" placeholder="Description"></td>
                                    </tr>
                                    <tr>
                                        <td style="width:10%"><b>tactic:</b></td>
                                        <td><input type="text" id="ability-tactic-name" placeholder="ATT&CK tactic"></td>
                                    <tr>
                                    <tr>
                                        <td style="width:10%"><b>technique:</b></td>
                                        <td><input type="text" id="ability-tech-id" placeholder="ATT&CK technique ID"></td>
                                    </tr>
                                    <tr>
                                        <td style="width:10%"><b>technique:</b></td>
                                        <td><input type="text" id="ability-tech-name" placeholder="ATT&CK technique name"></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="column" style="flex:10%">
                                <div>
                                    <img src="/gui/img/recycle.png">
                                    <p style="color:white;text-align: center;" onclick="freshId()">generate new id</p>
                                </div>
                            </div>
                            <div class="column" style="flex:10%">
                                <div>
                                    <img src="/gui/img/executor.png">
                                    <p style="color:white;text-align: center;" onclick="addExecutorBlock()">add executor</p>
                                </div>
                            </div>
                            <div class="column" style="flex:10%">
                                <div>
                                    <img src="/gui/img/payload.png">
                                    <form id="uploadPayloadForm">
                                       <label id="uploadFileLabel" for="uploadPayloadFile"><br><br>upload payload</label>
                                       <input type="file" id="uploadPayloadFile" style="display: none">
                                    </form>
                                </div>
                            </div>
                            <br><br>
                        </div>
                        <ul id="ttp-tests"></ul>
                        <div style="float:right;">
                            <button type="button" class="button-success atomic-button" onclick="saveAbility()">Save</button>
                            <button type="button" class="button-success atomic-button" onclick="addToPhase()">Add to phase</button>
                            <div id="ability-flashy-holder">
                                <span id="message"></span>
                            </div>
                        </div>
                    </div>
                    <div class="imgcontainer">
                        <span onclick="document.getElementById('phase-modal').style.display='none'" class="close" title="Close Modal">&times;</span>
                    </div>
                </div>
             </form>
        </div>

        <div id="potential-modal" class="modal">
            <form class="modal-content">
                <div class="container section-profile row ability-viewer modal-box">
                    <div class="topleft duk-icon"><img onclick="openDuk6()" src="/gui/img/duk.png"></div>
                    <div class="column" style="flex:100%;">
                        <select id="potential-agent-filter" onchange="fetchPotentialLinks('potential-modal');">
                            <option disabled selected>Choose an agent</option>
                        </select>
                        <select id="potential-link-tactic-filter" onchange="updateTacticFilter('potential-modal');">
                            <option disabled selected>Choose a tactic</option>
                            <option selected value="-- any --">-- any --</option>
                        </select>
                        <select id="potential-link-technique-filter" onchange="updateTechniqueFilter('potential-modal');">
                            <option disabled selected>Choose an technique</option>
                            <option selected value="-- any --">-- any --</option>
                        </select>
                        <h2 id="potential-links-count"></h2>
                        <ul id="potential-links"></ul>
                    </div>
                    <div class="imgcontainer">
                        <span onclick="closePotentialLinksModal()" class="close" title="Close Modal">&times;</span>
                    </div>
                </div>
             </form>
        </div>

        <div id="duk-modal" class="modal">
            <form class="modal-content">
                <div class="container modal-box">
                    <div class="row duk-modal">
                        <span onclick="document.getElementById('duk-modal').style.display='none'" class="close" title="Close Modal">&times;</span>
                        <div class="column" style="flex:8%">
                            <img src="/gui/img/duk.png"/>
                        </div>
                        <div class="column" style="flex:92%">
                            <p id="duk-text" style="color: white"></p>
                        </div>
                    </div>
                </div>
             </form>
        </div>

        <div id="loop-modal" class="modal section-profile">
            <form class="modal-content">
                <div class="container modal-box">
                    <div class="row duk-modal">
                        <div class="column" style="flex:25%">
                            <p id="hil-linkId"></p>
                            <h5 id="hil-paw"></h5>
                            <button class="atomic-button button-success approve" type="button" onclick="submitHilChanges(-3)">Approve</button>
                            <button class="atomic-button button-embedded discard" type="button" onclick="submitHilChanges(-2)">Discard</button>
                            <br><br>
                            <button class="atomic-button approveall" type="button" onclick="hilApproveAll()">Approve All</button>
                        </div>
                        <div class="column codearea" style="flex:75%">
                            <textarea id="hil-command" spellcheck="false"></textarea>
                        </div>
                    </div>
                </div>
             </form>
        </div>

        <div id="source-modal" class="modal">
            <form class="modal-content" style="width:50%;">
                <div class="container modal-box">
                    <div class="row ability-viewer">
                        <span onclick="document.getElementById('source-modal').style.display='none'" class="close" title="Close Modal">&times;</span>
                        <div class="column" style="flex:100%">
                            <center>
                                <span>Rules</span>
                                <h3 id="rules-name" style="margin-top:2px;text-align:center"></h3>
                                <ul id="source-rules"></ul>
                                <p style="color:white;text-align: right;" onclick="addRuleBlock()">&#10010;&nbsp;add rule</p>
                                <p style="font-size:12px;text-align:right">* Rules run in top-down order, in the same way as iptables</p>
                            </center>
                        </div>
                    </div>
                </div>
             </form>
        </div>

        <!-- templates -->

        <li id="potential-link-template" class="potential-links" style="display: none;margin-bottom:-50px">
            <div class="row-simple">
                <div class="column" style="flex:60%">
                    <hr>
                    <table frame=void style="border-spacing:5px;border-collapse:separate;width:100%">
                        <tr>
                            <td style="width:10%"><b>name:</b></td>
                            <td><p id="potential-name"></td>
                            <td style="width:10%"><button class="button-success potential-button" onclick="addLink($(this))">add</button></td>
                        </tr>
                        <tr>
                            <td style="width:10%"><b>technique:</b></td>
                            <td><p id="potential-technique"></td>
                        </tr>
                        <tr>
                            <td style="width:10%"><b>description:</b></td>
                            <td><p id="potential-description"></td>
                        </tr>
                        <tr>
                            <td style="width:10%"><b>command:</b></td>
                            <td><code contenteditable="true" id="potential-command"></code></td>
                        </tr>
                        <tr>
                            <td style="width:10%"><b>score:</b></td>
                            <td><p contenteditable="false" id="potential-score"></p></td>
                        </tr>
                    </table>
                </div>
            </div>
        </li>

        <li id="link-template" class="event" data-date="" style="display: none">
          <div class="member-infos">
            <h1 id="time-tactic" class="member-title"></h1>
            <div id="inner-contents">
              <div id="decision-card" class="decision-card">
                <table style="border-spacing:15px;">
                  <tr>
                    <td>Description:</td>
                    <td><p id="link-description" class="member-result"></p></td>
                  </tr>
                  <tr>
                    <td>Technique:</td>
                    <td><div class="tooltip" id="link-technique"></div></td>
                  </tr>
                  <tr>
                    <td>Collected:</td>
                    <td><p id="link-collect" class="member-result"></p></td>
                  </tr>
                  <tr>
                    <td>Finished:</td>
                    <td><p id="link-finish" class="member-result"></p></td>
                  </tr>
                  <tr>
                    <td>Command:</td>
                    <td><p id="time-action" class="member-result"></p></td>
                  </tr>
                  <tr>
                    <td>Executor:</td>
                    <td><p id="time-executor" class="member-result"></p></td>
                  </tr>
                  <tr>
                    <td>Paw</td>
                    <td><p id="paw-id" class="member-result"></p></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </li>

        <div id="phase-template" style="display: none;">
            <center>
                <ul id="profile-tests" class="profile-tests"></ul>
            </center>
        </div>

        <li id="rule-template" class="row-simple ttp-template" style="display: none;">
            <div class="column">
                <div class="dotted">
                    <b><p style="color:white" onclick="removeBlock($(this))">remove</p></b>
                </div>
                <table frame=void rules=rows style="border-spacing:20px;width:100%">
                    <tr>
                        <td style="width:20%"><b>trait:</b></td>
                        <td><input id="trait" contenteditable="false" spellcheck="false" style="width:100%;padding:0 15px;"></td>
                    </tr>
                    <tr>
                        <td style="width:20%"><b>match:</b></td>
                        <td><input id="match" contenteditable="false" spellcheck="false" style="width:100%;padding:0 15px;"></td>
                    </tr>
                    <tr>
                        <td style="width:20%"><b>action:</b></td>
                        <td><input id="action" contenteditable="false" spellcheck="false" style="width:100%;padding:0 15px;"></td>
                    </tr>
                </table>
            </div>
        </li>

        <li id="ability-template" class="ability-box" style="display: none">
            <h4 id="name" style="margin:5px"></h4>
            <b><p id="ability-attack" style="text-transform: uppercase;font-size:11px;opacity:0.7;"></p></b>
            <center>
                <p class="topright" id="ability-rm"></p>
                <table class="bottomright">
                    <tr id="ability-metadata"></tr>
                </table>
                <div id="icon-row" class="icon-row"></div>
            </center>
        </li>

        <li id="ttp-template" class="ttp-template" style="display: none">
            <div class="dotted">
                <b><p style="color:white" onclick="removeBlock($(this))">remove</p></b>
            </div>
            <table frame=void rules=rows style="border-spacing:5px;width:100%">
                <tr>
                    <td style="width:10%"><b>platform:</b></td>
                    <td>
                      <select id="ability-platform">
                        <option value="" disabled selected>Select a platform</option>
                            <option value="darwin">darwin</option>
                            <option value="linux">linux</option>
                            <option value="windows">windows</option>
                      </select>
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><b>executor:</b></td>
                    <td>
                      <select id="ability-executor">
                        <option value="" disabled selected>Select an executor</option>
                            <option value="sh">sh</option>
                            <option value="psh">psh</option>
                            <option value="pwsh">pwsh</option>
                            <option value="cmd">cmd</option>
                      </select>
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><b>payload:</b></td>
                    <td>
                      <select id="ability-payload" class="ability-payload">
                        <option value="" disabled selected>Download a payload before running this ability (optional)</option>
                        {% for p in payloads %}
                            <option value="{{ p }}">{{ p }}</option>
                        {% endfor %}}
                      </select>
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><b>command:</b></td>
                    <td><textarea id="ability-command" spellcheck="false" contenteditable="true" placeholder="Enter a command to execute"></textarea></td>
                </tr>
                <tr>
                    <td style="width:10%"><b>cleanup:</b></td>
                    <td><textarea id="ability-cleanup" spellcheck="false" contenteditable="true" placeholder="Enter a clean up command (optional)"></textarea></td>
                </tr>
            </table>
            <br>
        </li>

      </center>
    </div>
    <div id="atomic-canvas-end"></div>
  </center>
</div>
</body>
<script src="/gui/jquery/jquery.js"></script>
<script src="/gui/jquery/jquery-ui.js"></script>
<script src="/gui/jquery/jquery.dataTables.min.js"></script>
<script src="/gui/jquery/jquery.dataTables.select.min.js"></script>
<script src="/gui/js/sections.js"></script>
<script src="/gui/js/shared.js"></script>

<!-- Scripts and CSS file to support ColVis in DataTables -->
<script src="/gui/js/buttons.colVis.min.js"></script>
<script src="/gui/js/dataTables.buttons.min.js"></script>
<link rel="stylesheet" href="/gui/js/buttons.dataTables.css">
</html>
